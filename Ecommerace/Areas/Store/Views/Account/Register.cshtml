@model Ecommerace.ViewModels.Store.RegisterViewModel

@{

    Layout = "_AccountLayout";
    ViewData["Title"] = "Register";
}
<p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4 ">Register</p>

<form asp-action="Register" asp-area="Store" asp-controller="Account" class="mx-1 mx-md-4">
    <div asp-validation-summary="ModelOnly" class="text-danger mb-4"></div>

    <div class="d-flex flex-row align-items-center mb-4">
        <i class="fas fa-user fa-lg me-3 fa-fw text-primary"></i>
        <div data-mdb-input-init class="form-outline flex-fill mb-0">
            <input asp-for="UserName" class="form-control" />
            <label class="form-label" asp-for="UserName">Store Name</label>
            <span asp-validation-for="UserName" class="text-danger"></span>
        </div>
    </div>

    <div class="d-flex flex-row align-items-center mb-4">
        <i class="fas fa-envelope fa-lg me-3 fa-fw text-primary"></i>
        <div data-mdb-input-init class="form-outline flex-fill mb-0">
            <input asp-for="Email" class="form-control" />
            <label class="form-label" asp-for="Email">Email</label>
            <span asp-validation-for="Email" class="text-danger"></span>
        </div>
    </div>

    <div class="d-flex flex-row align-items-center mb-4">
        <i class="fas fa-lock fa-lg me-3 fa-fw text-primary" ></i>
        <div data-mdb-input-init class="form-outline flex-fill mb-0">
            <input asp-for="Password" type="password" class="form-control" />
            <label class="form-label" asp-for="Password">Password</label>
            <span asp-validation-for="Password" class="text-danger"></span>
        </div>
    </div>

    <div class="d-flex flex-row align-items-center mb-4">
        <i class="fas fa-key fa-lg me-3 fa-fw text-primary"></i>
        <div data-mdb-input-init class="form-outline flex-fill mb-0">
            <input asp-for="ConfirmPassword" type="password" class="form-control" />
            <label class="form-label" asp-for="ConfirmPassword">Confirm Password</label>
            <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
        </div>
    </div>

    <div class="d-flex flex-row align-items-center mb-4">
        <i class="fas fa-solid fa-map-pin fa-lg me-3 fa-fw text-primary"></i>
        <div data-mdb-input-init class=" flex-fill mb-0">
            <select class="form-control " name="CountryId" id="Countries" onchange="getStates()">
            <option disabled selected>--Country--</option>
            @foreach (var item in Model.CountriesList)
            {
                if (Model?.CountryId == item.Id)
                {
                    <option value="@item.Id" selected>@item.Name</option>
                }
                else
                {
                    <option value="@item.Id">@item.Name</option>
                }
            }
        </select>
            <span asp-validation-for="CountryId" class="text-danger"></span>
        </div>
    </div>

    <div class="d-flex flex-row align-items-center mb-4">
        <i class="fas fa-solid fa-map-pin fa-lg me-3 fa-fw text-primary"></i>
        <div data-mdb-input-init class=" flex-fill mb-0">
            <select class="form-control " name="StateId" id="States" onchange="GetCities()" >
                <option disabled selected>--State--</option>
            </select>
            <span asp-validation-for="CountryId" class="text-danger"></span>
        </div>
    </div>

    <div class="d-flex flex-row align-items-center mb-4">
        <i class="fas fa-solid fa-map-pin fa-lg me-3 fa-fw text-primary"></i>
        <div data-mdb-input-init class=" flex-fill mb-0">
            <select class="form-control " name="CityId" id="Cities">
                <option disabled selected>--City--</option>
            </select>
            <span asp-validation-for="CountryId" class="text-danger"></span>
        </div>
    </div>

    <div class="d-flex flex-row align-items-center mb-4">
        <i class="fas fa-solid fa-road fa-lg me-3 fa-fw text-primary"></i>
        <div data-mdb-input-init class="form-outline flex-fill mb-0">
            <input asp-for="Address" class="form-control" />
            <label class="form-label" asp-for="Address">Address</label>
            <span asp-validation-for="Address" class="text-danger"></span>
        </div>
    </div>

    <div class="d-flex justify-content-center mx-4 mb-3 mb-lg-4">
        <input type="submit" value="Register" class="btn btn-primary btn-lg" />
    </div>

</form>
<div class="text-center">
    <p>Already Have an Account ? <a asp-action="LogIn" asp-area="Store" asp-controller="Account">Log In</a></p>
</div>


<script>
    function getStates() {
        var selectedCountry = document.getElementById("Countries").value;
        var StatesElem = document.getElementById("States");

        StatesElem.innerHTML = "";
        // let option = document.createElement("option");
        // option.text = --State--;
        // option.setAttribute = "disabled";
        // StatesElem.add(option);
        console.log("countryId : ", selectedCountry);
        //Ajax Call
        $.ajax({
            url: "/store/Account/GetStates?id=" + selectedCountry,
            success: function (result) {
                console.log(result);
                for (let item of result) {
                    let option = document.createElement("option");
                    option.text = item.name;
                    option.value = item.id;
                    StatesElem.add(option);
                }

            }
        });
    }

    function GetCities(){
        var selectedState = document.getElementById("States").value;
        var CitiesElem = document.getElementById("Cities");

        CitiesElem.innerHTML = "";
        // let option = document.createElement("option");
        // option.text = --City--;
        // option.setAttribute = "disabled";
        // CitiesElem.add(option);
        console.log("StateId : ", selectedState);
        //Ajax Call
        $.ajax({
            url: "/store/Account/GetCities?id=" + selectedState,
            success: function (result) {
                console.log(result);
                for (let item of result) {
                    let option = document.createElement("option");
                    option.text = item.name;
                    option.value = item.id;
                    CitiesElem.add(option);
                }

            }
        });
    }
</script>